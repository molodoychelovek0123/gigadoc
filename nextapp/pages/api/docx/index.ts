import { NextApiRequest, NextApiResponse } from 'next';
import fs from 'fs/promises';

const html2docx = require('html2docx');

const htmlString = `<div id="A" style="background-color: transparent; min-height: 1000px; width: 100%; padding-top: 20px; overflow: auto;"><style></style><section style="width: 793px; min-height: 1122px; padding: 75px 56px 66px 113px;"><p class=" a a3" id="_GoBack"><span class=" a0" style="font-weight: 700;">П О С Т А Н О В Л Е Н И Е </span></p><p class=" a" style="text-align: center;"><span class=" a0" style="font-family: Times New Roman; font-weight: 700; font-size: 18px;">об отмене постановления об отказе в возбуждении уголовного дела</span></p><p class=" a" style="text-align: center;"><span class=" a0" style="font-family: Times New Roman; font-weight: 700; font-size: 18px;">и о возвращении материалов для дополнительной проверки</span></p><p class=" a" style="text-align: center;"></p><p class=" a" style="text-align: both;"><span class=" a0" style="font-family: Times New Roman; font-size: 18px;">город Моск</span><span class=" a0" style="font-family: Times New Roman; font-size: 18px;">ва</span><span class=" a0" style="font-family: Times New Roman; font-size: 18px;"></span><span class=" a0" style="font-family: Times New Roman; font-size: 18px;"></span><span class=" a0" style="font-family: Times New Roman; font-size: 18px;"></span><span class=" a0" style="font-family: Times New Roman; font-size: 18px;"></span><span class=" a0" style="font-family: Times New Roman; font-size: 18px;"></span><span class=" a0" style="font-family: Times New Roman; font-size: 18px;">               </span><span class=" a0" style="font-family: Times New Roman; font-size: 18px;"> </span><span class=" a0" style="font-family: Times New Roman; font-size: 18px;">дата</span></p><p class=" a" style="text-align: both;"></p><p class=" a a5" style="text-indent: 48px;"><span class=" a0">Первый заместитель </span><span class=" a0">_______</span><span class=" a0"> межрайонного прокурора города Москвы советник юстиции </span><span class=" a0">ФИО</span><span class=" a0">1 </span><span class=" a0">.</span><span class=" a0">, рассмотрев материал проверки ОМВД России по  району</span><span class=" a0">_______</span><span class=" a0"> г. Москвы </span><span class=" a0">КУСП </span><span class=" a0"> </span><span class=" a0">№ </span><span class=" a0">_______</span><span class=" a0">от </span><span class=" a0">_______</span><span class=" a0">, </span></p><p class=" a a5" style="text-indent: 48px;"></p><p class=" a a5" style="text-align: center;"><span class=" a0">У С Т А Н О В И Л:</span></p><p class=" a a5" style="text-align: center;"></p><p class=" a a5" style="text-indent: 48px;"><span class=" a0">В отдел </span><span class=" a0">МВД России по </span><span class=" a0">______</span><span class=" a0"> району</span><span class=" a0"> г. Москвы </span><span class=" a0">поступил материал проверки по </span><span class=" a0">сообщению </span><span class=" a0">___________________________</span></p><p class=" a a5" style="text-indent: 48px;"><span class=" a0">По данному факту ОМВД России по </span><span class=" a0">__________</span><span class=" a0">району г. Москвы проведена проверка в порядке ст. 144, 145 УПК РФ, по результатам которой на основании п. </span><span class=" a0">2</span><span class=" a0"> ч. 1 ст. 24 УПК РФ</span><span class=" a0"> </span><span class=" a0">_______</span><span class=" a0"> принято решение</span><span class=" a0"> об отказе </span><span class=" a0"></span><span class=" a0">в возбуждении уголовного дела.</span></p><p class=" a a5" style="text-indent: 48px;"><span class=" a0">Состоявшееся решение является незаконным, поскольку проверочные мероприятия проведены не в полном объеме, в ходе дополнительной проверки необходимо:</span></p><p class=" a a5" style="text-indent: 48px;"><span class=" a0">- </span></p><p class=" a" style="text-indent: 48px; text-align: both;"><span class=" a0" style="font-family: Times New Roman; font-size: 18px;">На основании изложенного и руководствуясь п. 6 ч. 2 ст. 37 УПК РФ, </span><span class=" a0" style="font-family: Times New Roman; font-size: 18px;"> ч. 6 ст. 148 УПК РФ,</span></p><p class=" a a5" style="text-align: center;"><span class=" a0">П О С Т А Н О В И Л:</span></p><p class=" a a5" style="text-align: center;"></p><p class=" a" style="text-indent: 47px; text-align: both;"><span class=" a0" style="font-family: Times New Roman; font-size: 18px;">1. Отменить постановление об отказе в возбуждении уголовного дела, </span><span class=" a0" style="font-family: Times New Roman; font-size: 18px;">вынесенное </span><span class=" a0" style="font-family: Times New Roman; font-size: 18px;">_______</span><span class=" a0" style="font-family: Times New Roman; font-size: 18px;"> </span><span class=" a0" style="font-family: Times New Roman; font-size: 18px;">у</span><span class=" a0" style="font-family: Times New Roman; font-size: 18px;">/у</span><span class=" a0" style="font-family: Times New Roman; font-size: 18px;"> ОМВД России</span><span class=" a0" style="font-family: Times New Roman; font-size: 18px;"> по </span><span class=" a0" style="font-family: Times New Roman; font-size: 18px;">____________ </span><span class=" a0" style="font-family: Times New Roman; font-size: 18px;">району</span><span class=" a0" style="font-family: Times New Roman; font-size: 18px;"> </span><span class=" a0" style="font-family: Times New Roman; font-size: 18px;"></span><span class=" a0" style="font-family: Times New Roman; font-size: 18px;">г. Москвы </span><span class=" a0" style="font-family: Times New Roman; font-size: 18px;">ФИО2</span><span class=" a0" style="font-family: Times New Roman; font-size: 18px;">.</span></p><p class=" a" style="text-indent: 47px; text-align: both;"><span class=" a0" style="font-family: Times New Roman; font-size: 18px;">2. Направить материал начальнику отдела МВД России по Южнопортовому району г. Москвы для проведения дополнительной проверки и устранения недостатков, препятствующих принятию законного </span><span class=" a0" style="font-family: Times New Roman; font-size: 18px;"></span><span class=" a0" style="font-family: Times New Roman; font-size: 18px;">и обоснованного решения.</span></p><p class=" a" style="text-indent: 47px; text-align: both;"><span class=" a0" style="font-family: Times New Roman; font-size: 18px;">3. Установить срок дополнительной проверки </span><span class=" a0" style="font-family: Times New Roman; font-size: 18px;">30</span><span class=" a0" style="font-family: Times New Roman; font-size: 18px;"> суток с момента поступления материала к исполнению.</span></p><p class=" a"></p><p class=" a" style="line-height: 100%;"></p><p class=" a" style="line-height: 100%;"><span class=" a0" style="font-family: Times New Roman; font-size: 18px;">Первый заместитель </span></p><p class=" a" style="line-height: 100%;"><span class=" a0" style="font-family: Times New Roman; font-size: 18px;">межрайонного прокурора                              </span><span class=" a0" style="font-family: Times New Roman; font-size: 18px;">   </span><span class=" a0" style="font-family: Times New Roman; font-size: 18px;">            </span><span class=" a0" style="font-family: Times New Roman; font-size: 18px;">   </span><span class=" a0" style="font-family: Times New Roman; font-size: 18px;">                             </span><span class=" a0" style="font-family: Times New Roman; font-size: 18px;">ФИО 1</span></p></section></div></body> </html>`;
const handler = async (req: NextApiRequest, res: NextApiResponse) => {
  // const r = await HTMLtoDOCX(htmlString, "", {}, "")
  const buffer = await html2docx.create(htmlString);

  await fs.writeFile('public\\b.docx', buffer);
};

export default handler;
